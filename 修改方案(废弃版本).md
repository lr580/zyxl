# 修改方案

## 概述

这次修改将包括之前提到的多个需求变更，并进行若干细节修改。列表如下：

1. （主要）增加竖屏视频和其他细节
2. 修改首页推荐算法
3. 删除树洞的回复功能以及与此关联的所有功能
4. 增加公众号的友链
6. 修改VR展、悄悄话和商城入口位置
6. 修改积分商城商品图片

**通过此次修改方案后，将封锁需求，直到修改方案完工前不再接受任何需求变更。**

预计在不晚于 6-1 完成全部内容。



## 细项

### 视频修改

#### 总览

1. 增设视频的播放模式，分为横屏视频和竖屏视频。
2. 细节修改：区分互动视频与非互动视频。对于非互动视频，取消展示“已存档”，“您已到达结局！”等文字展示。
4. 细节修改：考虑到事实上用户不关心视频发布者、且发布者目前有且仅有一个，删掉视频页对视频发布者昵称和头像的显示。

4. 修改视频分类，将原有五类进行修改



#### 细节

##### 竖屏视频

整体思路：模仿抖音

1. 用户无需选择，点击视频进行播放后会根据模式不同加载不同的播放器页面

2. 竖屏视频可以是互动视频、也可以不是互动视频

3. 竖屏视频点击后自动播放，但播放结束后不会循环播放

4. 右侧有点赞按钮，下方有视频标题、视频发布日期(年月日时分)、视频类型

5. 点击屏幕除按钮外任意地方暂停播放，再次点击继续播放；双击点赞

6. 因为竖屏约等于全屏，所以竖屏视频没有全屏按钮

7. 竖屏视频播放列表为当前分区内的全部视频，按发布时间由近到远排序

8. 手势上滑（定义为手指从上往下划动，使得页面显示视图向上移动；下滑定义同理类推）播放列表内上一个视频，手势下滑播放列表内下一个视频；

   如果在列表首个视频上滑播放最后一个视频、在列表最后一个视频下滑播放首个视频；如果列表只有一个视频无论上滑下滑都将重新播放自己；列表不可能没有视频（否则无法进入该页面）
   
9. 如果是互动视频，播放结束后，如果当前不是视频结尾，那么弹出若干个视频互动选项按钮，否则弹出提示告诉到达结尾。无论如何播放结束后都会弹出存档列表，点击列表项可以读档

10. 如果是互动视频，左划随时暂停并弹出存档列表；右滑隐藏存档列表



##### 类别

将原有五个类别感情、学习、心灵、职业、校园热点修改为下述五类：

1. 健康行为与生活方式
2. 生长发育与青春期保健
3. 心理健康
4. 传染病预防与突发公共卫生事件应对
5. 安全应急与避险

在剧场板块首页设五个大按钮，点击后分别进入这五类的视频列表。如下图所示：

<img src="img/image-20220509165923719.png" alt="image-20220509165923719" style="zoom:50%;" />

五类采用相同的排版。



##### 其他修改

如下图所示：下面对应内容(头像、昵称、"您已到达结局！"、"已存档")进行删除

<img src="img/image-20220506124536068.png" alt="image-20220506124536068" style="zoom:50%;" />



### 推荐算法

在首页推荐 $4$ 个视频(我们默认视频库视频总数大于等于 $4$ )，先从上到下后从左到右排序，即左上角是最推荐的视频、右上角是第二推荐、左下角是第三推荐、右下角是第四推荐。

具体推荐步骤如下：

1. 事先统计当前用户播放过(点击进去就算播放，不管秒退还是放完)的全部视频(不去重)，将播放过的所有类别按播放次数从高到低排序(若次数相等随机排序)，得到类别偏好排名

   如果未登录或未播放过视频，那么所有类别排名相等。

2. 在用户所有未播放过所有的视频里，按照上述类别排名逐个类别地挑出视频，直到挑出 $4$ 个视频为止。

   如果多个未播放视频处于同一个类别，将它们按照播放量从高到低排序(若播放量相等随机排序)。

   如果用户所有未播放过的视频不足 $4$ 个，那么将视频范围扩大到全体视频，重复第二步过程。

3. 用户可以选择点击按钮“换一批”，每次选择换一批前，当前 $4$ 个视频加入垃圾桶列表，在推荐的第二步中忽略掉垃圾桶内视频

   如果垃圾桶内视频过多以致于剩余视频不足 $4$ 个，则清空垃圾桶

   垃圾桶不进入历史记录，每次重新进入小程序时将初始化垃圾桶为空



### 其他

#### 删除树洞

删除掉树洞的回复功能。使得树洞实质上成为公告区，即只允许管理员发帖的论坛。

保留点赞功能。

与回复功能相关的一切功能进行调整：

- 删除“我”板块的“消息”、“树洞”、收藏列表和历史列表的“树洞”分区
- 删除帮助页与回复相关的一切文字

其他数据细节调整：

- 删掉全部测试用的、没有内容意义的帖子和回帖



#### 友链

目前有且仅有一条友链：微信公众号知音心流。如果有需要可以再加别的。

有两种实现方案：

1. 点击直达：点击按钮后跳转(如不能实现，考虑点击按钮后弹出第三方链接警告，确认后再跳转)
2. 只给信息：给定公众号的图标、名字，请用户自行搜索。

我们优先考虑实现第一种方案，如不可行，则实现第二种方案



#### 入口位置

修改VR展、悄悄话和商城入口位置，将其从首页板块移到"我"板块，用三个按钮代替。

首页板块新布局从上到下为横幅和推荐视频。



#### 积分商城

**所有商品仍然只能虚拟购买，购买后不能使用，只能在商城页看到自己买过多少个**

新增一个细节修改：每日登陆将获得 2 积分

删除全部已有商品。并增加新的商品：

1. 知音心流形象手办A，如果没有给定名字，默认取名为“玉露”，限量100个，价格10积分

2. 知音心流形象手办B，如果没有给定名字，默认取名为“锦乐”，限量100个，价格10积分

   （下图左为 A，右为 B）

   ![image-20220506134406424](img/image-20220506134406424.png)



